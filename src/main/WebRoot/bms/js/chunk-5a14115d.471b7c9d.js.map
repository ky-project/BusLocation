{"version":3,"sources":["webpack:///./src/views/path/HistoricalTrack.vue?a145","webpack:///./src/views/path/HistoricalTrack.vue?a571","webpack:///src/views/path/HistoricalTrack.vue","webpack:///./src/views/path/HistoricalTrack.vue?2f42","webpack:///./src/views/path/HistoricalTrack.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","model","value","consoleForm","callback","$$v","$set","expression","_l","item","key","id","sbrRouteName","on","searchHandler","_v","center","zoom","initMap","staticRenderFns","data","created","getAllRoutes","components","BaiduMap","methods","open","$confirm","msg","confirmButtonText","cancelButtonText","type","$axios","get","component"],"mappings":"yIAAA,yBAA8rB,EAAG,G,2CCAjsB,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,MAAM,CAAC,GAAK,qBAAqB,CAACF,EAAG,SAAS,CAACG,YAAY,WAAW,CAACH,EAAG,UAAU,CAACG,YAAY,eAAeD,MAAM,CAAC,QAAS,IAAO,CAACF,EAAG,eAAe,CAACA,EAAG,YAAY,CAACE,MAAM,CAAC,YAAc,SAASE,MAAM,CAACC,MAAOT,EAAIU,YAAmB,QAAEC,SAAS,SAAUC,GAAMZ,EAAIa,KAAKb,EAAIU,YAAa,UAAWE,IAAME,WAAW,wBAAwBd,EAAIe,GAAIf,EAAU,QAAE,SAASgB,GAAM,OAAOZ,EAAG,YAAY,CAACa,IAAID,EAAKE,GAAGZ,MAAM,CAAC,MAAQU,EAAKG,aAAa,MAAQH,EAAKE,SAAQ,IAAI,GAAGd,EAAG,eAAe,CAACA,EAAG,iBAAiB,CAACE,MAAM,CAAC,KAAO,OAAO,YAAc,SAASE,MAAM,CAACC,MAAOT,EAAIU,YAAsB,WAAEC,SAAS,SAAUC,GAAMZ,EAAIa,KAAKb,EAAIU,YAAa,aAAcE,IAAME,WAAW,6BAA6B,GAAGV,EAAG,eAAe,CAACA,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,WAAWc,GAAG,CAAC,MAAQpB,EAAIqB,gBAAgB,CAACrB,EAAIsB,GAAG,SAAS,IAAI,IAAI,GAAGlB,EAAG,MAAM,CAACG,YAAY,OAAO,CAACH,EAAG,YAAY,CAACG,YAAY,UAAUD,MAAM,CAAC,GAAK,mCAAmC,OAASN,EAAIuB,OAAO,KAAOvB,EAAIwB,MAAMJ,GAAG,CAAC,MAAQpB,EAAIyB,YAAY,IAAI,IAChmCC,EAAkB,G,wBCoCtB,GACEC,KADF,WAEI,MAAJ,CACM,YAAN,CACQ,QAAR,GACQ,WAAR,IAEM,KAAN,GACM,OAAN,GACM,KAAN,EACM,OAAN,CACQ,IAAR,GACQ,IAAR,IAEM,KAAN,GACM,IAAN,KAGEC,QAlBF,WAmBI3B,KAAK4B,gBAEPC,WAAY,CACVC,SAAJ,QAEEC,QAAS,CACPP,QADJ,YACA,qBAEM,KAAN,mBACM,KAAN,kBACM,KAAN,QAEM,KAAN,OACM,KAAN,MAEM,KAAN,wCACM,KAAN,mCAAQ,OAAR,6BAEIJ,cAbJ,WAaA,WAEM,GAAN,8BAEQ,OADA,KAAR,yBACA,EAEM,GAAN,iCAEQ,OADA,KAAR,yBACA,EAGM,IAAN,wCACA,kBACA,iBACA,cACA,GACQ,QAAR,yBACQ,WAAR,0CAEM,KAAN,iDACA,kBAEQ,EAAR,+BACU,IAAV,mDACU,EAAV,gBAGQ,EAAR,oBAEQ,IAAR,8BAAU,aAAV,IACQ,EAAR,kBAEQ,IAAR,yBACA,yBAAU,OAAV,IACQ,EAAR,UAAU,OAAV,OAAU,gBAAV,gBACQ,IAAR,yBAAU,OAAV,IACQ,EAAR,UAAU,OAAV,OAAU,gBAAV,gBAEQ,IAAR,6BACQ,EAAR,YACQ,IAAR,2CACQ,EAAR,YAEQ,EAAR,kBACQ,EAAR,kBAEQ,EAAR,yBAIIY,KA/DJ,SA+DA,KACMhC,KAAKiC,SAASC,EAAK,KAAM,CACvBC,kBAAmB,KACnBC,iBAAkB,KAClBC,KAAMA,KAIVT,aAvEJ,WAuEA,WACM,OAAO5B,KAAKsC,OAAOC,IAAI,6BAC7B,kBACQ,EAAR,yBCvI4c,I,wBCQxcC,EAAY,eACd,EACA1C,EACA2B,GACA,EACA,KACA,KACA,MAIa,aAAAe,E","file":"js/chunk-5a14115d.471b7c9d.js","sourcesContent":["import mod from \"-!../../../node_modules/_mini-css-extract-plugin@0.6.0@mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/_css-loader@1.0.1@css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./HistoricalTrack.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.6.0@mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/_css-loader@1.0.1@css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./HistoricalTrack.vue?vue&type=style&index=0&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"historical_track\"}},[_c('el-row',{staticClass:\"console\"},[_c('el-form',{staticClass:\"console-form\",attrs:{\"inline\":true}},[_c('el-form-item',[_c('el-select',{attrs:{\"placeholder\":\"请选择路线\"},model:{value:(_vm.consoleForm.routeId),callback:function ($$v) {_vm.$set(_vm.consoleForm, \"routeId\", $$v)},expression:\"consoleForm.routeId\"}},_vm._l((_vm.routes),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.sbrRouteName,\"value\":item.id}})}),1)],1),_c('el-form-item',[_c('el-date-picker',{attrs:{\"type\":\"date\",\"placeholder\":\"请选择日期\"},model:{value:(_vm.consoleForm.recodeTime),callback:function ($$v) {_vm.$set(_vm.consoleForm, \"recodeTime\", $$v)},expression:\"consoleForm.recodeTime\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.searchHandler}},[_vm._v(\"查询\")])],1)],1)],1),_c('div',{staticClass:\"map\"},[_c('baidu-map',{staticClass:\"bm-view\",attrs:{\"ak\":\"Hn8yCUyLlsPxzhCIdG8wETGiGtViLCHI\",\"center\":_vm.center,\"zoom\":_vm.zoom},on:{\"ready\":_vm.initMap}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div id=\"historical_track\">\r\n    <!-- 操作区 -->\r\n    <el-row class=\"console\">\r\n        <el-form :inline=\"true\" class=\"console-form\">\r\n            <el-form-item>\r\n                <el-select v-model=\"consoleForm.routeId\" placeholder=\"请选择路线\">\r\n                    <el-option v-for=\"item in routes\" :label=\"item.sbrRouteName\" :value=\"item.id\" :key=\"item.id\"></el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-date-picker\r\n                    v-model=\"consoleForm.recodeTime\"\r\n                    type=\"date\"\r\n                    placeholder=\"请选择日期\">\r\n                </el-date-picker>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-button type=\"primary\" @click=\"searchHandler\">查询</el-button>\r\n            </el-form-item>\r\n        </el-form>\r\n    </el-row>\r\n    <!-- 地图 -->\r\n    <!-- 百度地图 -->\r\n    <div class=\"map\">\r\n      <baidu-map \r\n        class=\"bm-view\" \r\n        ak=\"Hn8yCUyLlsPxzhCIdG8wETGiGtViLCHI\" \r\n        :center=\"center\" \r\n        :zoom=\"zoom\" \r\n        @ready=\"initMap\">\r\n      </baidu-map>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport BaiduMap from 'vue-baidu-map/components/map/Map.vue';\r\nexport default {\r\n  data(){\r\n      return {\r\n          consoleForm: {\r\n              routeId: '',\r\n              recodeTime: '',\r\n          },\r\n          path: [],\r\n          routes: [],\r\n          zoom: 0,\r\n          center: {\r\n              lng: '',\r\n              lat: '',\r\n          },\r\n          BMap: {},\r\n          map: {},\r\n      }\r\n  },\r\n  created(){\r\n    this.getAllRoutes();\r\n  },\r\n  components: {\r\n    BaiduMap,\r\n  },\r\n  methods: {\r\n    initMap({BMap, map}){\r\n        //1. 初始化地图\r\n        this.center.lng = 116.404;\r\n        this.center.lat = 39.915;\r\n        this.zoom = 15;\r\n        \r\n        this.BMap = BMap;\r\n        this.map = map;\r\n\r\n        this.map.addControl(new BMap.NavigationControl());\r\n        this.map.addControl(new BMap.ScaleControl({anchor: BMAP_ANCHOR_BOTTOM_RIGHT}));  \r\n    },\r\n    searchHandler(){\r\n        // 验证\r\n        if(this.consoleForm.routeId === ''){\r\n          this.open('请选择路线','warning');\r\n          return false;\r\n        }\r\n        if(this.consoleForm.recodeTime === ''){\r\n          this.open('请选择日期','warning');\r\n          return false;\r\n        }\r\n        // 查询\r\n        let date = new Date(this.consoleForm.recodeTime);\r\n        let y = date.getFullYear(); \r\n        let m = date.getMonth() + 1;\r\n        let d = date.getDate();\r\n        let data = {\r\n          routeId: this.consoleForm.routeId,\r\n          recodeTime: `${y}-${m}-${d}`,\r\n        }\r\n        this.$axios.post('/busposition/m/positionHis/list',data)\r\n          .then(res=>{\r\n            // 保存历史路线数据\r\n            res.data.data.forEach(item=>{\r\n              let point = new this.BMap.Point(item.sbp_longitude,item.sbp_latitude);\r\n              this.path.push(point);\r\n            })\r\n            // 清空地图内容\r\n            this.map.clearOverlays();\r\n            // 画轨迹\r\n            var line = new this.BMap.Polyline(this.path,{strokeWeight: 3});\r\n            this.map.addOverlay(line);\r\n            // 画起止点\r\n            let labelOffset = new this.BMap.Size(-5,28);\r\n            let startLabel = new this.BMap.Label('起点',{offset: labelOffset});\r\n            startLabel.setStyle({ border: 'none', backgroundColor: 'transparent'});\r\n            let endLabel = new this.BMap.Label('终点',{offset: labelOffset});\r\n            endLabel.setStyle({ border: 'none', backgroundColor: 'transparent'})\r\n\r\n            let startMarker = new BMap.Marker(this.path[0]);\r\n            startMarker.setLabel(startLabel);\r\n            let endMarker = new BMap.Marker(this.path[this.path.length - 1])\r\n            endMarker.setLabel(endLabel);\r\n\r\n            this.map.addOverlay(startMarker);\r\n            this.map.addOverlay(endMarker);\r\n            // 移动到轨迹初始点\r\n            this.map.panTo(this.path[0]);\r\n          })\r\n    },\r\n    // 弹框\r\n    open(msg,type) {\r\n      this.$confirm(msg, '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: type,\r\n      })\r\n    },\r\n    // 获取路线信息\r\n    getAllRoutes(){\r\n      return this.$axios.get('/busposition/m/route/list')\r\n        .then(res=>{\r\n          this.routes = res.data.data;\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\">\r\n#historical_track {\r\n  .console {\r\n    position: absolute;\r\n    top: 15px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    z-index: 100;   \r\n    .console-form {\r\n      display: inline-block;\r\n    }\r\n    input,select,button {\r\n        box-shadow: 2px 2px 2px #ccc;\r\n    }\r\n  }\r\n  .map {\r\n    min-width: 300px;\r\n    height: calc(~\"100vh -  131px\");\r\n    background-color: #ccc;\r\n    .bm-view {\r\n      height: calc(~\"100vh -  131px\");\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./HistoricalTrack.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./HistoricalTrack.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./HistoricalTrack.vue?vue&type=template&id=7f129fbe&\"\nimport script from \"./HistoricalTrack.vue?vue&type=script&lang=js&\"\nexport * from \"./HistoricalTrack.vue?vue&type=script&lang=js&\"\nimport style0 from \"./HistoricalTrack.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}